const ContactFormController=(function(){return{config:{endpoint_contact:"/utils?action=contact",form_class:".contact_form",submit_class:".submit_contact_form",},init:function(){this.localize_error_messages();this.create_listeners();},contact_performed_callback:function(){},localize_error_messages:function(){if(typeof $.i18n==="object"){$.extend(jQuery.validator.messages,{required:$.i18n._("T_campo_obligatorio"),email:$.i18n._("T_email_email"),url:$.i18n._("T_url_valida"),date:$.i18n._("T_date_wrong"),dateISO:$.i18n._("T_date_ISO"),number:$.i18n._("T_numero_valido"),digits:$.i18n._("T_cvv_digits"),creditcard:$.i18n._("T_cardNumber_creditcard"),equalTo:$.i18n._("T_mismo_valor"),accept:$.i18n._("T_extension_valida"),maxlength:$.validator.format($.i18n._("T_maximo_caracteres")),minlength:$.validator.format($.i18n._("T_minimo_caracteres")),rangelength:$.validator.format($.i18n._("T_longitud_caracteres")),range:$.validator.format($.i18n._("T_rango_numeros")),max:$.validator.format($.i18n._("T_menor_igual")),min:$.validator.format($.i18n._("T_mayor_igual")),});}},create_listeners:function(){$(this.config.form_class).find(this.config.submit_class).on("click",function(e){e.preventDefault();ContactFormController.submit_form();});$(this.config.form_class).keypress((e)=>{if(e.which==13){e.preventDefault();ContactFormController.submit_form();}});},form_validator:function(form_container){let is_success=true;if(form_container.find("input[name=email]").length){let email_input=form_container.find("input[name=email]");const emailReg=/^$|^([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)$/;if(!emailReg.test(email_input.val())){is_success=false;email_input.addClass("error");return;}
email_input.removeClass("error");}
form_container.find(".required").each(function(){var html_type=$(this).attr("type");let validation_list=["tel","text","email","date",];if(html_type==="checkbox"||html_type==="radio"){let input_name=$(this).attr('name');if(!$(`input[name='${input_name}']`).is(":checked")){is_success=false;$(this).addClass("error");return;}}else{if($(this).is('select')||validation_list.includes(html_type)){if(!$(this).val()){is_success=false;$(this).addClass("error");return;}}}
$(this).removeClass("error");});return is_success;},create_form_params:function(){let return_dict={};$(this.config.form_class).find("input, select, textarea").each(function(){let name=$(this).attr("name");if(!name){return;}
if($(this).attr("type")==="checkbox"||$(this).attr("type")==="radio"){if($(this).prop("checked")){return_dict[name]=$(this).val();}}else{return_dict[name]=$(this).val();}
if($(this).is("select")){let target_email=$(this).find("option:selected").attr("data-target-email");if(target_email){return_dict.destination_email=target_email;}}});return return_dict;},clean_form:function(){$(this.config.form_class).find("input, select, textarea").each(function(){let input_type=$(this).attr("type");if(input_type==="radio"||input_type==="checkbox"){$(this).prop("checked",false);}else if(input_type!=="hidden"){$(this).val("");}});},thanks_message:function(){alert($.i18n._("T_gracias_contacto"));},thanks_section_redirect:function(url_parameter){window.location=url_parameter;},captcha_is_valid:function(){let target_response_recaptcha=$(this.config.form_class).find("#g-recaptcha-response"),recaptcha_wrapper=$(this.config.form_class).find(".g-recaptcha");if(!target_response_recaptcha.length){return true;}
if(!target_response_recaptcha.val()){recaptcha_wrapper.addClass("error");return false;}else{recaptcha_wrapper.removeClass("error");return true;}},submit_form:function(){if(this.form_validator($(this.config.form_class))&&this.captcha_is_valid()){let post_params=this.create_form_params();$.post(this.config.endpoint_contact,post_params,function(){ContactFormController.contact_performed_callback();let thanks_input_redirect=$(ContactFormController.config.form_class).find("#thanks_redirect");ContactFormController.send_datalayer_event();if(thanks_input_redirect.length&&thanks_input_redirect.val().indexOf("http")!==-1){ContactFormController.thanks_section_redirect(thanks_input_redirect.val());}else{ContactFormController.thanks_message();}
ContactFormController.clean_form();});if(typeof HubspotController!=="undefined"){HubspotController.sendData(post_params,'contact');}}else{console.log("Form not valid");}},send_datalayer_event:function(){let dataLayer=window.dataLayer||[];dataLayer.push({event:"contactFormSubmitted",});},};})();